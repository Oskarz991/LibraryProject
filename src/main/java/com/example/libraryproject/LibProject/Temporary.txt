Oskar,Andersson,1999,1838,3,0,2022-05-23,Undergraduate Student
Stefan,Andersson,3999,1399,3,0,2022-05-23,Undergraduate Student



   public void lendBook(Book theBook, int userId)throws IOException {

       Scanner bookScanLend = new Scanner(AllBooksFile).useDelimiter(",");

       ArrayList<Book> bookList = new ArrayList<Book>();

       while (bookScanLend.hasNext()) {
           int Id = Integer.parseInt(bookScanLend.next());
           String Name = bookScanLend.next();
           int ISBNScan = Integer.parseInt(bookScanLend.next());
           int Quantity = Integer.parseInt(bookScanLend.next());
           String Author = bookScanLend.nextLine();
           Author = Author.replace(",", "");
           bookList.add(new Book(Id, Name, ISBNScan, Quantity, Author));
       }
    if (theUser.LoanCounter < 0) {
        for (Book books : bookList) {
            if (books.Title.equals(theBook.Title)) {
                if (books.Quantity > 0) {

                    Scanner userLoanScan = new Scanner(UserLoanFile).useDelimiter(",");

                    books.Quantity--;

                    PrintWriter printWriterAllBooks = new PrintWriter(AllBooksFile);

                    for (Book book : bookList) {
                        printWriterAllBooks.println(book.export(book));

                    }

                    printWriterAllBooks.close();

                    PrintWriter printWriter = new PrintWriter(UserLoanFile);

                    printWriter.println(books.Title + "," + books.ISBN + "," + userId);

                    printWriter.close();

                    ArrayList<User>userList = new ArrayList<User>();

                    Scanner userScan = new Scanner(UserFile).useDelimiter(",");

                    while (userScan.hasNext()){
                        String Name = userScan.next();
                        String SurName = userScan.next();
                        int PNumber = Integer.parseInt(userScan.next());
                        int Id = Integer.parseInt(userScan.next());
                        int LoanCounter = Integer.parseInt(userScan.next());
                        int ViolationCounter = Integer.parseInt(userScan.next());
                        String Role = userScan.nextLine();
                        Role = Role.replace(",","");

                        userList.add(new User(Name,SurName,PNumber,Id,LoanCounter,ViolationCounter,Role));
                    }



                    theUser.LoanCounter--;

                    PrintWriter printWriterUserList = new PrintWriter(UserFile);

                    for (User user:userList) {
                        printWriter.println(user.export(user));
                    }

                    printWriter.close();




                    break;
                } else {
                    System.out.println("The book is not available right now");
                }

            } else {
                System.out.println("The book does not exists");
            }

        }
    }else
        System.out.println("No more loans from you mister!!!");
   }